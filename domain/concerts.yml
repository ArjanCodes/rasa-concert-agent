version: "3.1"

slots:
  artist:
    type: text
    mappings:
      - type: from_llm
    initial_value: null

  genre:
    type: categorical
    mappings:
      - type: from_llm
    values:
      - "rock"
      - "pop"
      - "jazz"
      - "any"
    initial_value: "any"

  date_range:
    type: text
    mappings:
      - type: from_llm
    initial_value: "any"

  start_date:
    type: text
    mappings:
      - type: from_llm
    initial_value: null

  end_date:
    type: text
    mappings:
      - type: from_llm
    initial_value: null

  matched_concerts:
    type: list
    mappings:
      - type: controlled
    initial_value: []

  selected_concert:
    type: text
    mappings:
      - type: from_llm

  name:
    type: text
    mappings:
      - type: from_llm

  email:
    type: text
    mappings:
      - type: from_llm

  exclude_keywords:
    type: text
    mappings:
      - type: from_llm
    initial_value: "default"

responses:

  utter_ask_artist:
    - text: "Are you looking for a specific artist?"

  utter_ask_genre:
    - text: "What type of music are you interested in? (rock, pop, jazz, or any)"

  utter_ask_start_date:
    - text: "When would you like to go?"

  utter_ask_end_date:
    - text: "And how long are you thinking? Just that day or through when?"

  utter_ask_exclude_keywords:
    - text: "What would you like me to exclude from the search?"

  utter_ask_selected_concert:
    - text: "Which concert would you like to book?"

  utter_ask_name:
    - text: "What name should I put the ticket under?"

  utter_ask_email:
    - text: "What email address should I send the confirmation to?"

  utter_booking_complete:
    - text: "Your ticket for {selected_concert} has been booked under the name {name}. A confirmation has been sent to {email}."

  utter_no_matches_found:
    - condition: (slots.artist is not null or slots.genre is not null) and slots.date_range is not null
      text: "Unfortunately I don't see {% if artist %}{{artist}}{% elif genre and genre != 'any' %}any {{genre}} concerts{% else %}any concerts{% endif %}{% if date_range and date_range != 'any' %} for {{date_range}}{% endif %}."
      metadata:
        template: jinja
    - text: "Unfortunately I don't see any concerts matching your criteria."

actions:
  - action_find_concerts_by_genre_and_date
  - action_book_concert_ticket
